{% extends "base.html" %}
{% load extras %}
{% block title %}Accession {{accession.accession_number}} {% endblock title %}
{% block content %}
<section id=central_column>
    <h2> Passport data for {{accession.accession_number }}</h2>
    <div class='accession_table'>
	    <table class="data_table">
	    <tr>
	        <td class="key">Accession number :</td>
	        <td class="value">{{accession.accession_number}}</td>
	    </tr>
	    {% if accession.donor_accession %}
	        <tr>
	          <td class="key">Donor</td>
	          <td class="value">{{ accession.donor_accession}}</td>
	        </tr>
	    {% endif %}
	    {%if accession.collecting_accession %}
	        <tr>
	          <td class="key">Collecting number</td>
	          <td class="value">{{ accession.collecting_accession|last}}</td>
	        </tr>
	    {% endif %}
	    {% if accession.duplicated_accessions %}
	      {% with dup_accs=accession.duplicated_accessions%}
	        <tr>
	            <td class="key">Duplicated accessions in other databases</td>
	            <td class="value"></td>
	        </tr>
	                {% for dup_acc in dup_accs %}
	                <tr>
	                    <td></td>
	                    <td>{{dup_acc|link_if_url:dup_acc}}</td>
	                 </tr>
	                 {% endfor %}
	      {% endwith %}
	    {% endif %}
	    {% if accession.organism %}
	       <tr>
                <td class="key">Organism</td>
                <td class="value">{{ accession.organism }}</td>
            </tr>
	    {% endif %}
	    </table>
	 </div>
	 <hr class='empty_line'>
    {% if accession.passport%}
      {% with pass=accession.passport %}
      <div id="passport_data_map">
	      <div class='passport_table'>
	        <table class="data_table">
	            {% for shown_str, prop_content in pass.data_to_show.items %}
	                {% if prop_content %}
	                  <tr>
	                    <td  class="key">{{shown_str}}</td>
	                    <td>{{ prop_content}}</td>
	                  </tr>
	                {% endif %}     
	            {% endfor %}
	        </table>
	      </div>  
	      {% endwith %} 
		    {% if accession.passport.location.longitude and accession.passport.location.latitude %}
		        <div id="googleMap" style="width:500px;height:400px;"></div>
		        <script>
		            function initialize() {
		                var myLatLng = {lat: {{accession.passport.location.latitude}}, lng: {{accession.passport.location.longitude}}};
		                var map = new google.maps.Map(document.getElementById('googleMap'), {
		                                    zoom: 8,
		                                    center: myLatLng
		                });   
		                var marker = new google.maps.Marker({
		                                    position: myLatLng,
		                                    map: map
		                              });
		                }
		           {# google.maps.event.addDomListener(window, 'load', initialize);   #}
		        </script>
			<script async defer <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC9POnisKiXih3_mmFz6otHjbR9YM1OhWw&callback=initialize" ></script>
		    {% endif %}
    </div>
    {% endif %}
</section>
    
{% endblock %}
